Bootstrap: docker
From: vllm/vllm-openai:v0.10.0

%environment
    export SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt
    export PYTHONNOUSERSITE=1
    export VLLM_ALLOW_INSECURE_SERIALIZATION=1

%post
    apt-get update && \
    apt-get install -y --no-install-recommends git curl ca-certificates ripgrep
    
    pip install --upgrade pip
    
    # Same torch/flash-attn setup as training container
    pip install torch==2.7.1+cu128 --index-url https://download.pytorch.org/whl/cu128
    pip install --no-build-isolation --prefer-binary flash-attn==2.8.0.post2
    pip install --no-build-isolation flashinfer-python
    
    # Benchmark packages
    git clone https://github.com/sierra-research/tau-bench /tmp/tau-bench && \
    cd /tmp/tau-bench && pip install -e . && cd /
    
    # Nano
    pip install nano-agent gitpython
    # Mini-Swe-Agent and SWE Bench
    pip install mini-swe-agent
    # Aider
    pip install aider-install aider-chat
    # Misc
    pip install openai anthropic requests jsonlines datasets